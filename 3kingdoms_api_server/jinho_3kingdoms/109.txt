서기 253년 가을, 촉한의 장군 강유는 20만 대군을 일으켜 요화, 장익을 좌우 선봉으로 삼고, 하후패를 참모로 임명했다. 장익을 운량사로 임명하고, 대군을 이끌고 양평관을 나서 위나라를 공격했다. 강유가 하후패와 상의하며 말했다. "이전에 옹주를 공격하려 했으나 실패하고 돌아왔다. 이번에 다시 출병하면 반드시 준비가 되어 있을 것이다. 공은 어떤 고견이 있는가?" 하후패가 대답했다. "농상 여러 군 중에서 남안이 가장 풍부한 식량을 가지고 있다. 먼저 남안을 점령하면 기반이 될 수 있다. 이전에 실패한 것은 강병이 오지 않았기 때문이다. 지금은 사람을 먼저 보내어 농우에서 강병을 모은 후, 병력을 출병시켜 석영을 지나 동정을 통해 남안을 직접 공격해야 한다." 강유는 크게 기뻐하며 말했다. "공의 말이 매우 훌륭하다!" 그리하여 강유는 거정에게 금과 보석, 촉나라 비단을 가지고 가서 강왕과 우호를 맺게 했다. 강왕 천미당은 선물을 받고 5만 병력을 일으켜 강 장수 아하소가를 대선봉으로 삼아 병력을 이끌고 남안으로 향했다. 위나라의 좌장군 곽회가 이 소식을 듣고 급히 낙양으로 보고했다. 사마사가 장군들에게 물었다. "누가 감히 촉나라 군대를 막겠는가?" 보국장군 서질이 대답했다. "제가 가겠습니다." 사마사는 서질의 용맹을 잘 알고 있어 마음속으로 크게 기뻐하며, 즉시 서질을 선봉으로 삼고 사마소를 대도독으로 임명하여 병력을 이끌고 농서로 진격하게 했다. 군대가 동정에 도착하니 마침 강유와 마주쳤다. 두 군대가 진을 갖추고 서질이 커다란 도끼를 휘두르며 출전했다. 촉나라 진영에서 요화가 맞서 싸웠으나 몇 합을 넘기지 못하고 패배하여 물러났다. 이어서 장익이 말을 타고 창을 들고 나섰으나 역시 몇 합을 넘기지 못하고 진영으로 물러났다. 서질이 병력을 이끌고 공격하자 촉나라 군대는 크게 패하여 30여 리 후퇴했다. 사마소도 병력을 거두어 각자 진으로 돌아갔다. 강유가 하후패와 상의하며 말했다. "서질이 매우 용맹한데 어떻게 그를 잡을 수 있을까?" 하후패가 대답했다. "내일 거짓 패배를 가장하여 매복으로 그를 잡는 것이 좋겠습니다." 강유가 말했다. "사마소는 사마중달의 아들로, 병법을 잘 알 것이다. 지형을 보고 의심하여 추격하지 않을 것이다. 하지만 우리가 이 계책으로 유인하면 서질을 잡을 수 있다." 그리하여 강유는 요화에게 이렇게 하라고 명령했고, 장익에게도 같은 명령을 내렸다. 두 사람이 병력을 이끌고 떠났다. 한편 군사들에게 철제 함정을 길에 뿌리고, 진영 밖에 많은 장애물을 설치하여 장기전에 대비하는 모습을 보였다. 서질이 연일 병력을 이끌고 도전했으나 촉나라 군대는 나오지 않았다. 정찰 말이 사마소에게 보고했다. "촉나라 군대가 철롱산 뒤에서 목우 유마로 양초를 운반하고 있는데, 이는 장기전을 준비하는 것 같습니다. 다만 강병의 지원을 기다리고 있는 것 같습니다." 사마소가 서질을 불러 말했다. "이전에 우리가 촉나라를 이긴 것은 그들의 양도를 차단했기 때문이다. 지금 촉나라 군대가 철롱산 뒤에서 양초를 운반하고 있으니, 오늘 밤 병력 5천을 이끌고 그들의 양도를 차단하면 촉나라 군대는 물러날 것이다." 서질이 명령을 받고, 초경에 병력 5천을 이끌고 철롱산으로 향했다. 과연 촉나라 병사 200여 명이 목우 유마를 몰고 양초를 운반하고 있었다. 위나라 병사들이 일제히 함성을 지르면서 서질이 앞장서서 막았다. 촉나라 병사들이 양초를 버리고 도망쳤다. 서질이 병력을 반으로 나누어 양초를 운반하게 했고, 자신은 나머지 병력을 이끌고 추격했다. 10리를 쫓아가니 앞에 수레와 장비가 길을 막고 있었다. 서질이 병사들에게 수레를 해체하라고 명령하자, 양쪽에서 갑자기 불이 일었다. 서질이 급히 말을 돌려 도망치려 하였으나 뒤쪽 좁은 산길에도 수레가 길을 막고 있었고, 불길이 치솟았다. 서질과 병사들은 연기를 뚫고 말을 타고 빠져나갔다. 한편에서 포성이 울리더니 양쪽에서 병사들이 달려왔다. 왼쪽에는 요화, 오른쪽에는 장익이 병사들을 이끌고 달려와 크게 싸웠다. 위나라 병사들은 크게 패하여 도망쳤다. 서질은 목숨을 걸고 홀로 도망쳤으나, 사람과 말이 지쳐 있었다. 달아나는 중에 앞에서 병사들이 나타났으니 바로 강유였다. 서질이 크게 놀라 당황하였으나, 강유의 창에 찔려 말에서 떨어졌다. 서질은 촉나라 병사들에게 난도질당해 죽었다. 서질이 나눈 병력 중 양초를 운반하던 병력도 하후패에게 잡혀 모두 항복했다. 하후패는 위나라 병사들의 갑옷과 말을 촉나라 병사들에게 입히고, 위나라 군기의 깃발을 들고 작은 길로 위나라 진영으로 돌아갔다. 위나라 군사들이 자기 부대 병사들이 돌아오는 줄 알고 성문을 열어 들여보냈다. 촉나라 병사들이 들어가자마자 진영에서 싸움이 벌어졌다. 사마소는 크게 놀라 급히 말을 타고 도망치려 했으나 앞에서 요화가 달려왔다. 사마소는 앞으로 나아가지 못하고 급히 후퇴하려 하니 강유가 병력을 이끌고 작은 길로 달려왔다. 사마소는 사방이 막혀 어쩔 수 없이 철롱산으로 올라가 방어했다. 이 산은 오직 한 길만 있고, 사방이 험준하여 오르기 어려웠다. 산 위에는 샘 하나가 있어 겨우 100명이 마실 수 있을 뿐이었다. 이때 사마소의 병력은 6천 명이었다. 강유가 길목을 차단하고, 산 위의 샘물도 부족하여 사람과 말이 말라갔다. 사마소가 하늘을 우러러 크게 탄식하며 말했다. "나는 이곳에서 죽는구나!" 후인이 시를 지어 말하였다. "강유의 기묘한 계책은 평범하지 않다. 위나라 군대는 철롱산에서 고립되었다. 팽갱은 처음으로 마릉도에 들어섰고, 항우는 처음으로 구리산을 포위하였다." 주부 왕도가 말했다. "예전에 경공이 고립되었을 때, 샘을 파서 샘물을 얻었다. 장군께서도 이와 같이 해보시지요." 사마소가 그 말을 따라 산 정상의 샘물 옆에서 두 번 절하고 기도하며 말했다. "내가 조정의 명을 받아 촉나라 군대를 물리치러 왔습니다. 만약 내가 죽게 된다면 이 샘물이 마를 것이고, 내가 스스로 목을 베어 부하들을 모두 항복시키겠습니다. 만약 내 명이 다하지 않았다면 하늘이여, 속히 이 샘물을 솟아나게 하여 많은 사람을 살려주십시오!" 기도가 끝나자 샘물이 솟아나와 끊이지 않았다. 이로 인해 사람과 말이 죽지 않았다.
///
강유는 산 아래에서 위나라 군대를 포위하고 여러 장수들에게 말했다. "예전에 승상께서 상방곡에서 사마의를 잡지 못한 것이 깊이 한이 되었는데, 이번에는 사마소를 반드시 잡을 것이다." 

한편, 곽회가 사마소가 철롱산에 갇힌 것을 듣고 군대를 이끌고 구원하려 하니, 진태가 말했다. "강유가 강병과 합류하여 남안을 먼저 취하려고 합니다. 이제 강병이 이미 도착했으니 장군이 군대를 철수하여 구원하면 강병이 틈을 타서 우리 뒤를 공격할 것입니다. 먼저 사람을 보내 강병에게 항복하는 척하여 내부에서 일을 도모한 후에야 철롱산의 포위를 풀 수 있을 것입니다." 

곽회가 이를 따랐고, 진태에게 5천 명의 병력을 주어 강왕의 진영으로 보내어 갑옷을 벗고 들어가 울며 절하였다. "곽회가 오만하여 항상 저를 죽이려 했으니 여기로 투항하였습니다. 곽회의 군 중 상황을 모두 알고 있으니, 오늘 밤에 군을 이끌고 적진을 습격하면 성공할 것입니다. 제가 위나라 진영에 도착하면 내응할 것입니다." 

강왕이 크게 기뻐하여 오하소가와 함께 진태를 보내어 위나라 진영을 습격하게 했다. 오하소가는 진태의 항복한 병사들을 후미에 두고 자신은 강병을 이끌고 앞장섰다. 이윽고 이경에 위나라 진영에 도착하니 진영 문이 활짝 열려 있었다. 진태가 먼저 말을 타고 진입하였고, 오하소가가 창을 잡고 진입하자마자 함정에 빠져 죽고 말았다. 

진태가 뒤에서 공격하고, 곽회가 좌측에서 공격하니 강병이 크게 어지러워져 서로 짓밟고 죽었으며, 살아남은 자는 모두 항복하였다. 오하소가는 자결하였다. 곽회와 진태가 병력을 이끌고 강병의 진영으로 직진하여 강왕이 급히 말을 타려는 순간 생포하여 곽회에게 데려갔다. 

곽회가 급히 말에서 내려 그를 위로하며 말했다. "조정은 공을 충의로 여기니 어찌하여 촉나라를 도우려고 하십니까?" 강왕은 부끄러워하며 죄를 인정하였다. 곽회는 강왕에게 말했다. "공이 앞장서서 철롱산의 포위를 풀면 촉나라 군대를 물리친 후에 천자가 큰 상을 내릴 것입니다." 

강왕이 이를 따랐고, 강병과 위나라 병력을 이끌고 철롱산으로 향했다. 이경쯤 되어 강유에게 이를 알리니 강유가 크게 기뻐하며 맞이하였다. 위나라 병사들이 강병 사이에 섞여 있었고, 촉나라 진영 앞에 도착하자 강유가 병력을 진영 밖에 배치하고 강왕이 100여 명을 이끌고 중군으로 향했다. 강유와 하후패가 맞이하러 나오자, 위나라 장수들이 강왕이 말하기도 전에 뒤에서 습격하였다. 

강유는 크게 놀라 급히 말을 타고 도망쳤다. 강병과 위나라 병사들이 일제히 진입하여 촉나라 군대는 사방으로 흩어져 도망쳤다. 강유는 무기를 갖고 있지 않아 허리의 화살통에는 화살이 없고 빈 통만 남아 있었다. 산속으로 도망치다가 곽회가 병력을 이끌고 따라오자, 강유가 빈 활을 쏘는 시늉을 하였다. 곽회는 여러 번 피하다가 화살이 없음을 알고 활을 쏘아 강유를 맞히려 하였다. 

강유가 피하며 곽회의 화살을 잡아 다시 쏘았고, 곽회는 맞아 떨어졌다. 강유가 돌아서서 곽회를 죽이려 하였으나, 위나라 병사들이 달려와 곽회를 구하였다. 곽회는 결국 피를 흘리다 죽고 말았다. 사마소가 산에서 내려와 병력을 이끌고 추격하려 하였으나 중간에 돌아갔다. 하후패는 강유와 함께 도망쳤다. 

강유는 많은 병력을 잃고 한중으로 돌아갔다. 비록 패배하였으나 곽회와 서질을 죽여 위나라의 위세를 꺾었다. 사마소는 강병을 위로하고 돌려보낸 후 낙양으로 돌아갔다. 사마소와 그의 형 사마사는 조정을 장악하였고, 군신들은 감히 따르지 못하였다. 

위나라의 황제 조방은 사마사를 볼 때마다 두려워하여 마치 등에 바늘이 꽂힌 듯하였다. 하루는 조방이 조회를 열고 사마사가 칼을 차고 들어오자 급히 내려와 맞이하였다. 사마사가 웃으며 말했다. "어찌 군주가 신하를 맞이하는 예가 있습니까? 편히 계십시오." 

잠시 후 군신들이 상소를 올리자 사마사가 모두 직접 처리하고 위나라 황제에게 보고하지 않았다. 사마사가 물러나며 당당하게 궁궐을 나서니 수천 명이 앞뒤로 따랐다. 조방은 후궁으로 물러나 좌우를 보니 여럿이 없고 세 명만 있었다. 태상 하후현, 중서령 이풍, 광록대부 장집이었다. 장집은 장황후의 아버지로 조방의 황장이다. 조방이 신하들을 물리고 세 사람과 밀실에서 상의하였다. 

조방이 장집의 손을 잡고 울며 말했다. "사마사는 나를 어린아이처럼 여기고, 백관을 하찮게 여기니, 나라가 곧 그의 손에 넘어갈 것입니다!" 

이 풍이 말했다. "폐하, 걱정하지 마십시오. 신이 부족하나, 폐하의 명을 받아 사방의 영웅을 모아 이 도적을 제거하겠습니다." 

하후현이 말했다. "신의 형 하후패가 촉나라에 항복한 것은 사마사 형제가 해칠까 두려워서입니다. 이제 이 도적을 제거한다면 형이 반드시 돌아올 것입니다. 신은 나라의 옛 친족으로 감히 간신이 나라를 어지럽히는 것을 보고만 있을 수 없습니다. 폐하의 명을 받들어 함께 토벌하겠습니다." 

조방이 말했다. "다만 두려울 뿐이다." 

세 사람이 울며 말했다. "신들이 한 마음으로 도적을 제거하여 폐하께 보답하겠습니다!" 

조방이 용을 그린 옷을 벗어 손가락을 깨물어 피로 조서를 써서 장집에게 주며 말했다. "나의 조부 무황제가 동승을 주살한 것은 기밀이 누설되었기 때문이니, 그대들은 신중히 하여 밖으로 누설되지 않도록 하라." 

이 풍이 말했다. "폐하, 어찌 그런 불리한 말씀을 하십니까? 신들은 절대 누설하지 않겠습니다." 
///동승 등의 무리는, 사마사와 어떻게 무비조와 견줄 수 있겠습니까? 폐하께서 의심하십니다." 세 사람이 물러나 동화문 왼쪽에 이르렀을 때, 마침 사마사가 칼을 차고 오고 있었고, 그를 따르는 수백 명이 모두 무기를 들고 있었다. 세 사람이 길가에 서 있었다. 사마사가 물었다. "너희 세 사람은 왜 늦게까지 물러나지 않았느냐?" 이풍이 대답했다. "성상께서 내정에서 책을 보고 계셔서, 저희 세 사람이 시독을 하였을 뿐입니다." 사마사가 물었다. "어떤 책을 보았느냐?" 이풍이 대답했다. "여름, 상, 주 삼대의 책입니다." 사마사가 말하였다. "상께서 이 책을 보시고 무슨 이야기를 물으셨느냐?" 이풍이 대답했다. "천자가 물으신 것은 이윤(伊尹)이 상나라를 돕고, 주공(周公)이 섭정하던 일입니다. 저희는 모두 '지금의 사마 대장군께서 바로 이윤과 주공입니다.'라고 아뢰었습니다." 사마사가 냉소하며 말하였다. "너희들이 어찌 나를 이윤과 주공에 견줄 수 있겠느냐! 그 마음은 실로 나를 왕망(王莽)과 동탁(董卓)에 비유하는구나!" 세 사람이 모두 말하였다. "저희 세 사람은 모두 장군의 문하에 있는 사람들인데, 어찌 감히 그런 말을 할 수 있겠습니까?" 사마사가 크게 노하여 말하였다. "너희들은 아첨하는 자들이다! 방금 천자와 밀실에서 무슨 일로 울었느냐?" 세 사람이 대답했다. "실로 그런 일이 없었습니다." 사마사가 꾸짖어 말하였다. "너희 세 사람의 눈물이 아직 붉은데, 어찌 부인하느냐!" 하후현이 일이 이미 새어나간 것을 알고는 큰 소리로 욕하며 말하였다. "우리가 운 것은 너의 위세가 주인을 진동시키고, 장차 반역을 꾀하려 하기 때문이다!" 사마사가 화가 나서 무사들에게 하후현을 잡으라고 명했다. 하후현이 주먹을 휘두르며 사마사를 공격했으나 무사들에게 붙잡혔다. 사마사는 사람들을 수색하게 하였고, 장집의 몸에서 용봉(龍鳳) 무늬의 땀에 젖은 옷을 찾아냈는데, 그 위에 피로 쓴 글자가 있었다. 좌우가 사마사에게 바쳤다. 사마사가 보니, 밀서였다. 밀서의 내용은 사마사 형제가 대권을 쥐고, 장차 반역을 도모하려 한다. 모든 조치와 명령은 모두 짐의 뜻이 아니니, 각 부대 관병들이 충의로서 함께 적신을 토벌하고 사직을 바로 세우라. 공을 이루는 날에는 더 큰 상을 내릴 것이다. 사마사가 다 읽고 크게 노하여 말하였다. "원래 너희들이 우리 형제를 해치려는 것이었구나! 이는 용납할 수 없다!" 이에 세 사람을 시장에서 허리 잘라 죽이고, 삼족을 멸하라고 명했다. 세 사람은 욕을 멈추지 않았다. 동시장에 이르러, 이빨이 모두 부러지고, 말이 흐릿해진 채로 죽었다. 사마사는 곧바로 후궁으로 들어갔다. 위주 조방은 마침 장황후와 이 일을 의논하고 있었다. 황후가 말하였다. "내정에 귀와 눈이 많으니, 일이 새어나가면 반드시 저를 해칠 것입니다!" 말을 마치기도 전에, 사마사가 들어오는 것을 보고 황후가 크게 놀랐다. 사마사는 칼을 잡고 조방에게 말하였다. "신의 부친께서 폐하를 군주로 세우신 공덕은 주공(周公)보다 못하지 않다. 신이 폐하를 섬기며 이윤(伊尹)과 다를 바가 없는데, 오히려 은혜를 원수로 여기고 공을 죄로 삼아, 소인들과 함께 신의 형제를 해치려 하니, 어찌된 일입니까?" 조방이 말하였다. "짐에게는 그런 마음이 없습니다." 사마사는 소매에서 땀에 젖은 옷을 꺼내어 땅에 던지며 말하였다. "이것은 누가 만든 것입니까?" 조방은 혼이 날아가고 넋이 흩어져, 떨며 대답했다. "이 모두 다른 사람의 강요로 인한 것입니다. 짐이 어찌 감히 그런 마음을 품을 수 있겠습니까?" 사마사가 말하였다. "대신을 모함하여 반역죄를 지으려 한 자는 어떤 죄를 받아야 합니까?" 조방이 무릎을 꿇고 말하였다. "짐이 죄를 지었으니, 대장군께서 용서해 주시기를 바랍니다!" 사마사가 말하였다. "폐하께서 일어나십시오. 국법은 폐할 수 없습니다." 이에 장황후를 가리키며 말하였다. "이 사람은 장집의 딸이니, 당연히 제거해야 합니다!" 조방이 크게 울며 용서를 구했으나, 사마사는 따르지 않고 좌우에게 명하여 장황후를 동화문 안으로 끌고 가서, 흰 비단으로 목을 졸라 죽였다. 후일에 시인이 말하였다. "당년 복황후가 궁문을 나설 때, 맨발로 울부짖으며 황제와 작별하였는데, 사마사가 오늘 이를 따라, 하늘이 되갚음을 하도록 하였구나." 다음 날, 사마사는 군신들을 크게 모으고 말하였다. "지금 군주는 음란하고 무도하여, 창녀와 광대를 가까이하고, 간언을 듣고 현로의 길을 막으니, 그 죄가 한나라의 창읍왕보다 심하여 천하를 다스릴 수 없다. 나는 이윤(伊尹)과 곽광(霍光)의 법을 따라 새 군주를 세워 사직을 보전하고 천하를 안락하게 하려 한다. 어떠한가?" 모두가 응답하였다. "대장군께서 이윤과 곽광의 일을 행하시니, 하늘의 뜻을 따른 것이며, 누가 감히 명을 거역하겠습니까?" 사마사는 여러 관리들과 함께 영녕궁에 들어가 태후께 아뢰었다. 태후가 말하였다. "대장군은 누구를 군주로 세우려 하시오?" 사마사가 말하였다. "臣은 팽성왕 조거를 보니, 총명하고 인효하여 천하의 주인이 될 수 있습니다." 태후가 말하였다. "팽성왕은 나의 숙부인데, 이제 군주로 세우면, 내가 어찌 감히 이를 감당하겠습니까? 지금 고귀향공 조모가 있으니, 그는 문황제의 손자로, 온건하고 겸손하여 군주로 세울 만합니다. 경들 대신들이 길게 의논하십시오." 한 사람이 아뢰었다. "태후의 말씀이 옳습니다. 곧바로 세울 수 있습니다." 모두가 보니, 사마사의 종숙인 사마부였다. 사마사는 곧 사자를 보내 원성으로 가서 고귀향공을 청하고, 태후를 태극전으로 모시고, 조방을 꾸짖어 말하였다. "너는 음란하고 무도하여, 창녀와 광대를 가까이하고, 천하를 다스릴 수 없다. 옥새를 내려놓고 다시 제왕의 작위를 받아야 하니, 지금 떠나지 않으면 다시는 조정에 들어올 수 없다." 조방이 태후에게 울며 절하고, 국보를 내려놓고 왕차를 타고 크게 울며 떠났다. 오직 몇 명의 충신들만이 눈물을 머금고 전송하였다. 후일에 시인이 말하였다. "옛날 조조가 한나라를 협박하여, 과부와 고아를 속였구나. 누가 알았으랴, 사십여 년 후에 과부와 고아도 속임을 당하리라!" 한편, 고귀향공 조모는, 자는 언사로, 문황제의 손자이며 동해정왕 조림의 아들이었다. 그날 사마사는 태후의 명으로 조모를 불렀고, 문무 관리들이 서액문 밖에서 맞이할 준비를 하였다. 조모가 황급히 예를 갖추어 답례하였다. 태위 왕숙이 말하였다. "군주께서는 답례할 필요가 없습니다." 조모가 말하였다. "나 또한 인신(人臣)인데, 어찌 예를 갖추지 않겠습니까?" 문무 관리들이 조모를 부축하여 연에 오르게 하였으나, 조모는 사양하며 말하였다. "태후의 명을 받들었으나, 무엇 때문인지 모르니, 어찌 감히 연에 오르겠습니까?" 이에 걸어서 태극동당에 이르렀다. 사마사가 맞이하여 보니, 조모가 먼저 절을 하였고, 사마사는 급히 일으켜 세웠다. 인사를 마치고, 태후를 만나러 갔다. 태후가 말하였다. "내가 너를 어릴 적에 보니, 제왕의 모습이 있었다. 이제 천하의 주인이 될 수 있으니, 반드시 공검하고 검소하게 덕을 펼쳐 선제를 욕되게 하지 말아라." 조모가 여러 번 사양하였다. 사마사는 문무 관리들에게 조모를 태극전에서 모시라고 명하였고, 그날 새 군주로 세워 가평 6년을 정원 원년으로 고치고, 천하에 대사면을 내렸다. 대장군 사마사에게 황월을 주고, 조회에 나아갈 때 걷지 않고, 상주를 할 때 이름을 부르지 않으며, 칼을 차고 전각에 오를 수 있도록 하였다. 문무 백관들에게는 각각 봉작과 하사를 내렸다. 정원 2년 봄 정월에, 세작이 날아와 보고하기를, 진동장군 무구검과 양주자사 문흠이 폐주를 명분으로 군사를 일으켰다는 것이었다. 사마사가 크게 놀랐다. 한나라의 신하가 왕을 돕고자 하는 뜻이 있었듯이, 위나라의 장수도 도적을 토벌하고자 하는 것이었다. 어떻게 적을 맞이할지, 다음 이야기를 보라.