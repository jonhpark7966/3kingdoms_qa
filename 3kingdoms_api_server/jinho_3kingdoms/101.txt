제갈량은 병력을 줄이고 화로를 늘리는 방법을 사용해 한중으로 퇴각했다. 사마의는 매복이 있을까 두려워 추격하지 못하고 장안으로 돌아갔다. 이로 인해 병력을 잃지 않았다. 제갈량은 삼군에게 큰 상을 내린 후, 성도로 돌아가 후주를 만났다.

"노신이 기산을 나와 장안을 취하려 했으나, 폐하의 조서를 받고 돌아왔습니다. 무슨 큰일이 있습니까?"

후주는 잠시 말이 없더니, "그저 상국의 얼굴이 보고 싶어 조서를 내렸을 뿐, 다른 일은 없소,"라고 답했다.

제갈량은 말했다. "이것은 폐하의 본심이 아니오. 반드시 간신이 헛된 말을 했을 것이오."

후주는 말없이 있었다. 제갈량은 다시 말했다. "노신은 선제의 두터운 은혜를 받아 죽음으로 보답하려 했소. 만약 내에 간신이 있다면 어찌 적을 토벌할 수 있겠소?"

후주는 말했다. "짐은 환관의 말을 듣고 일시적으로 상국을 소환했소. 오늘에서야 깨달아 후회하오."

제갈량은 환관들을 불러 조사하니, 비어있는 말이었음을 알게 되었다. 급히 사람을 보내 보완하려 했으나, 이미 위국으로 도망친 후였다. 제갈량은 헛된 상소를 올린 환관을 처형하고, 나머지는 모두 궁 밖으로 내쫓았다. 또한 장완, 비의를 엄하게 꾸짖었다. 두 사람은 죄를 인정하고 사죄했다.

제갈량은 후주에게 작별을 고하고 다시 한중으로 돌아갔다. 한편으로는 이엄에게 군량을 보내도록 지시하고, 다시 출병을 논의했다. 양의가 말했다. "전에는 병력을 많이 동원해 피로가 누적되고, 군량도 부족했습니다. 이제 병력을 나누어 세 달을 기한으로 돌려가며 쓰는 것이 좋을 듯합니다. 예를 들어 20만 병력 중 10만 명만 출병하고, 세 달 후 교체하면 병력의 피로가 없을 것입니다."

제갈량은 말했다. "이 말이 내 뜻과 같소. 중원을 정벌하는 것은 하루아침에 끝낼 일이 아니오. 장기적인 계획이 필요하오." 이에 병력을 두 부대로 나누어 백일을 기한으로 순환시키고, 기한을 어기면 군법에 따라 처벌하게 했다.

건흥 9년 봄 2월, 제갈량은 다시 위국을 정벌했다. 당시 위국은 태화 5년이었다. 위주 조예는 제갈량이 다시 중원을 정벌하자 급히 사마의를 소환했다. 사마의는 말했다. "지금 자단이 죽었으니, 신이 한 몸을 다해 적을 토벌하고자 하오." 조예는 기뻐하며 연회를 열어 대접했다. 다음 날, 촉병이 급박하게 쳐들어왔다는 보고가 있었다. 조예는 즉시 사마의를 출병시켜 적을 막게 했다.

사마의는 장안으로 가서 여러 장수들을 모아 촉병을 무찌를 계책을 논의했다. 장합이 말했다. "제가 군을 이끌고 용과 미를 지키며 촉병을 막겠습니다." 사마의는 말했다. "장군의 전군은 홀로 제갈량의 대군을 막을 수 없소. 병력을 분산시키는 것은 승산이 없소. 상규를 지키고, 나머지 병력은 기산으로 보내는 것이 좋겠소. 선봉을 맡을 수 있겠소?"

장합은 기뻐하며 말했다. "저는 충성을 다해 나라에 보답하고자 했으나, 알아주는 이가 없었소. 이제 도독께서 중책을 맡겨주니 목숨을 걸고 임하겠소." 이에 사마의는 장합을 선봉으로 삼고, 대군을 총지휘하게 했다. 또 곽회를 낭서의 여러 군을 지키게 했다. 나머지 장수들은 각기 다른 길로 나아갔다.

전군의 정찰병이 보고했다. "제갈량이 대군을 이끌고 기산으로 향하고, 선봉 왕평과 장익은 진창을 지나 검각을 통과해 산관으로 향하고 있습니다." 사마의는 장합에게 말했다. "제갈량이 길게 진격해 올 것이니, 낭서의 밀을 베어 군량으로 삼으려 할 것이오. 기산에 진을 치고, 내가 곽회와 함께 천수의 여러 군을 순찰하며 적병이 밀을 베지 못하게 막겠소." 장합은 4만 병력을 이끌고 기산을 지켰다. 사마의는 대군을 이끌고 낭서로 향했다.

제갈량은 기산에 도착해 진을 치고, 이미 위병이 준비되어 있음을 보고 말했다. "이는 사마의가 틀림없소. 지금 진중에 군량이 부족하니, 이엄에게 곡식을 보내라고 재촉해야 하오. 낭서의 밀은 익었을 테니, 몰래 병력을 이끌고 베어야 하오." 이에 왕평, 장익, 오반, 오의 네 장수를 기산에 남겨두고, 제갈량은 강유, 위연 등과 함께 노성으로 갔다. 노성 태수는 제갈량을 알고 있었기에, 급히 성문을 열고 항복했다. 제갈량은 위로한 후 물었다. "지금 어디의 밀이 익었소?" 태수는 말했다. "낭서의 밀은 이미 익었소."

제갈량은 장익과 마충을 노성에 남기고, 여러 장수와 삼군을 이끌고 낭서로 향했다. 정찰병이 보고했다. "사마의가 병력을 이끌고 이곳에 있습니다." 제갈량은 놀라며 말했다. "그가 내가 밀을 베러 올 것을 미리 알았구나!" 이에 목욕하고 옷을 갈아입은 후, 세 대의 네 바퀴 수레를 준비했다. 수레 위에는 모두 똑같은 장식을 했다. 이는 제갈량이 촉에서 미리 만들어 둔 것이었다.

제갈량은 강유에게 천 명의 군사를 이끌고 수레를 호위하고, 오백 명의 군사는 북을 치며 상규 뒤에 매복하게 했다. 마대는 왼쪽에, 위연은 오른쪽에 각기 천 명의 군사를 이끌고 수레를 호위하고, 오백 명의 군사는 북을 치게 했다. 각 수레에는 스물네 명이 검은 옷을 입고 맨발로 머리를 풀고 검을 들고, 좌우에서 수레를 밀었다. 세 사람은 각기 명령을 받고 병력을 이끌고 수레를 밀며 나아갔다. 제갈량은 다시 3만 명의 군사에게 낫과 줄을 들고 대기하며 밀을 베라고 명령했다.사마의는 왼쪽 전선에서 큰 북소리가 들려오자 급히 병사들에게 저항을 명령했다. 촉병대 안에 24명이 머리를 풀고 검을 든 채 흑의와 맨발로 사마의를 에워싸며 사륜차를 호위하고 있었다. 차 위에는 제갈량이 단정히 앉아 있었다. 사마의는 크게 놀라며 말했다. "방금 전 사륜차 위에 앉아 있던 제갈량이 50리를 쫓아도 따라잡지 못했는데, 어떻게 여기에 또 제갈량이 있는가? 이상하도다! 이상하도다!" 말을 다 하지도 못했는데, 오른쪽 전선에서 또다시 전투 북소리가 들리며 또 한 무리의 촉병이 몰려왔다. 사륜차 위에도 제갈량이 앉아 있었고, 좌우에 역시 24명이 흑의와 맨발로 머리를 풀고 검을 든 채 차를 호위하고 있었다. 사마의는 매우 의심스러워하며 여러 장수들을 돌아보며 말했다. "이것은 반드시 신병일 것이다!" 병사들은 크게 혼란에 빠져 감히 싸우지 못하고 각자 달아났다. 가는 도중에 갑자기 북소리가 크게 울리며 또 한 무리의 촉병이 몰려왔다. 앞장선 사륜차에는 제갈량이 단정히 앉아 있었고, 좌우에 차를 미는 자들도 앞서와 똑같았다. 위병들은 모두 놀라지 않을 수 없었다. 사마의는 이것이 사람인지 귀신인지 알 수 없었고, 또 촉병이 얼마나 많은지 알 수 없어 크게 두려워하며 급히 병사들을 이끌고 상규로 달려가 성문을 닫고 나오지 않았다. 이때 제갈량은 이미 3만 정병을 시켜 녹상의 밀을 모두 베어 염성으로 운반해 햇볕에 말리고 있었다. 사마의는 상규성 안에서 사흘 동안 감히 성문을 열고 나오지 못했다. 후에 촉병이 퇴각하는 것을 보고서야 병사들을 내보내 정찰하게 했다. 길에서 한 촉병을 잡아 사마의에게 데려갔다. 사마의가 물었다. 그 사람이 답했다. "저는 밀을 베는 사람이었는데, 말이 길을 잃어 잡혀왔습니다." 사마의가 물었다. "전에 본 신병은 무엇이냐?" 답했다. "세 갈래 매복 병사들로 모두 제갈량이 아니고, 강유, 마대, 위연이었습니다. 각 갈래에는 한 명의 병사가 차를 호위하며, 500명의 병사가 북을 쳤습니다. 단지 처음에 와서 유인한 차에 타고 있던 자가 제갈량이었습니다." 사마의는 하늘을 우러러 길게 탄식하며 말했다. "제갈량은 신출귀몰한 계책을 가지고 있구나!" 갑자기 부도독 곽회가 들어오기를 청했다. 사마의는 예를 갖추어 맞이했다. 곽회가 말했다. "촉병이 많지 않다는 소식을 들었는데, 지금 염성에서 밀을 말리고 있으니 공격할 수 있습니다." 사마의는 앞서의 일을 자세히 말했다. 곽회는 웃으며 말했다. "잠시 속였을 뿐입니다. 지금 이미 알아차렸으니, 무슨 대수이겠습니까! 제가 한 군을 이끌고 후방을 공격하고, 공이 한 군을 이끌고 전방을 공격하면 염성을 함락하고 제갈량을 사로잡을 수 있습니다." 사마의가 따르니, 병력을 나누어 두 갈래로 나아갔다. 제갈량은 군사를 이끌고 염성에서 밀을 말리고 있다가 갑자기 여러 장수를 불러 명령을 내렸다. "오늘 밤 적이 반드시 성을 공격할 것이다. 내가 계산해보니 염성의 동서쪽 밀밭 안에 충분히 매복할 수 있다. 누가 나를 위해 가겠는가?" 강유, 위연, 마대, 마충 네 장수가 나서며 말했다. "저희가 가겠습니다." 제갈량은 크게 기뻐하며 명했다. "강유와 위연은 각각 2천 병사를 이끌고 동남, 서북 두 곳에 매복하라. 마대와 마충은 각각 2천 병사를 이끌고 서남, 동북 두 곳에 매복하라. 단지 포성이 들리면 네 모퉁이에서 일제히 공격하라." 네 장수가 병사를 이끌고 명령을 받고 떠났다. 제갈량은 스스로 백여 명을 이끌고 각자 화포를 가지고 성을 나와 밀밭 안에 매복했다. 사마의는 병사를 이끌고 염성으로 곧장 갔는데, 이미 날이 어두워져 여러 장수들에게 말했다. "낮에 병사를 진격시키면 성 안에 반드시 준비가 있을 것이다. 지금 밤을 이용해 공격하라. 이곳 성은 낮고 도랑이 얕아 쉽게 돌파할 수 있다." 병사를 성 밖에 주둔시켰다. 한밤중이 되어 곽회도 병사를 이끌고 왔다. 양쪽 병사가 합쳐져 북소리와 함께 염성을 사방에서 철통같이 포위했다. 성 위에서는 만 개의 쇠뇌가 일제히 발사되며 화살과 돌이 비처럼 쏟아졌다.병사들은 감히 앞으로 나아가지 못했다. 갑자기 위군 중에서 신호 포성이 연달아 울리자 삼군이 크게 놀라 또 어디서 병력이 오는지 몰랐다. 곽회가 사람을 시켜 밀밭을 수색하게 하니, 사방에서 불빛이 하늘을 찌르고 함성이 크게 울리며 네 갈래의 촉병이 일제히 공격해 왔다. 노성의 사문이 모두 열리고 성 안의 병사들이 나와 내외가 합세하여 크게 싸우니, 위군의 사상자가 무수히 많았다. 사마의는 패한 병사를 이끌고 죽을 힘을 다해 포위망을 뚫고 산꼭대기를 차지했고, 곽회도 패한 병사를 이끌고 산 뒤에 진을 쳤다. 공명이 성으로 들어가 네 장수에게 사방에 진을 치게 했다. 곽회가 사마의에게 말했다. "지금 촉병과 대치한 지 오래인데 퇴각할 방도가 없습니다. 방금 또 한 차례 전투에서 3천여 명이 손실되었습니다. 만약 서둘러 대책을 세우지 않으면 후일 퇴각하기 어려울 것입니다." 사마의가 물었다. "어찌하면 좋겠소?" 곽회가 말했다. "격문을 보내어 옹주와 량주의 병력을 모아 함께 적을 섬멸합시다. 제가 군을 이끌고 검각을 습격하여 그들의 퇴로를 차단하겠습니다. 그리하여 양식 공급을 막아 삼군이 혼란에 빠지게 한 후 기세를 몰아 공격하면 적을 멸할 수 있을 것입니다." 사마의는 그 말을 따랐다. 격문을 보내어 별을 밤새 달려 옹주와 량주에 사람과 말을 조달했다. 며칠 지나지 않아 대장 손례가 여러 군의 병력을 이끌고 도착했다. 사마의는 즉시 손례에게 곽회와 약속하여 검각을 습격하게 했다. 한편 공명은 노성에서 오랫동안 대치하면서도 위군이 출전하지 않자 마대와 강유를 불러 명령했다. "지금 위군이 산의 험준한 곳을 지키며 싸우지 않는 것은 첫째, 우리가 곡식을 다 써서 양식이 없을 것이라고 예상한 것이고, 둘째, 병력을 보내 검각을 습격하여 우리의 양식길을 차단하려는 것이다. 너희 둘은 각각 만 명의 군사를 이끌고 먼저 험준한 곳을 지켜라. 위군이 준비된 것을 보면 자연히 물러갈 것이다." 두 사람은 군을 이끌고 떠났다. 장사 양의가 공명에게 와서 보고했다. "재상님께서 대군을 백일마다 교대하라고 명령하셨는데, 이제 한계 시간이 다 되었고 한중의 병력이 이미 천구를 나왔습니다. 공문이 도착하여 교대 병력을 기다리고 있습니다. 현재 8만의 군이 남아있고, 그 중 4만 명이 교대될 예정입니다." 공명이 말했다. "이미 명령을 받았으니, 즉시 시행하라." 군사들이 이를 듣고 각각 정비하여 출발을 준비했다. 갑자기 손례가 옹주와 량주의 병력 20만을 이끌고 검각을 습격하고, 사마의가 직접 군을 이끌고 노성을 공격해 온다는 소식이 들려왔다. 촉군은 모두 크게 놀랐다. 양의가 공명에게 말했다. "위군이 매우 급하게 다가오니, 재상께서는 교대 병력을 잠시 남겨 두어 적을 물리치고, 신병이 도착한 후에 교대하는 것이 좋겠습니다." 공명이 말했다. "안 된다. 내가 병사를 사용하고 장수를 명하는 것은 신용을 기본으로 한다. 이미 명령을 내렸으니 신의를 잃을 수 없다. 더구나 촉군이 돌아가야 할 자들은 모두 귀가 준비를 하며 그들의 부모와 처자가 문 앞에서 기다리고 있다. 내가 지금 큰 어려움이 있더라도 그들을 붙잡아 두지 않겠다." 즉시 명령을 내려 돌아갈 병사들에게 당일로 출발하라고 했다. 군사들이 이를 듣고 모두 크게 외쳤다. "재상께서 이렇게 은혜를 베푸시니, 저희는 돌아가지 않고 목숨을 바쳐 위군을 크게 무찌르고 재상께 보답하겠습니다!" 공명이 말했다. "너희들은 마땅히 집으로 돌아가야 하니, 어찌 다시 여기에 머물 수 있겠느냐?" 군사들 모두 싸우기를 원하고 집으로 돌아가기를 원하지 않았다. 공명이 말했다. "너희들이 이미 나와 함께 싸우고자 한다면, 성 밖에 나가 진을 치고 위군이 도착하면 그들이 숨을 고를 틈 없이 급히 공격하라. 이는 이일대로를 기다려 싸우는 방법이다." 군사들은 명령을 받고 각자 무기를 들고 기뻐하며 성을 나가 진을 치고 기다렸다. 서량의 병력은 길을 두 배로 달려왔기 때문에 사람과 말이 지쳐 있었다. 막 진을 치고 쉬려고 했는데, 촉군이 일제히 공격해 오자 한 사람도 용감히 싸우며 예리한 병사들을 앞세워 서량의 병력은 저항하지 못하고 후퇴했다. 촉군은 힘을 다해 추격하여 서량의 병력 시체가 들판에 가득하고 피가 흘러 강을 이루었다. 공명이 성 밖으로 나와 승리한 병력을 모아 성으로 들어가 상을 주고 노고를 치하했다. 갑자기 영안의 이엄이 급히 서신을 보내왔다. 공명이 크게 놀라 봉인을 풀고 보았다. 서신에는 "최근 동오에서 사람을 낙양으로 보내 위나라와 연합하려 한다고 합니다. 위나라가 동오에게 촉나라를 대신 치라고 했으나, 다행히 동오는 아직 병력을 일으키지 않았습니다. 이제 이엄이 소식을 알아내어 재상께 조속히 대책을 세워주시길 바랍니다." 공명은 이를 보고 매우 놀라 의심스러워하며 장수들을 모아 말했다. "만약 동오가 병력을 일으켜 촉을 침범하면 나는 신속히 돌아가야 한다." 즉시 명령을 내려 기산의 대군을 서천으로 후퇴하게 했다. "사마의가 내가 군을 이끌고 여기에 주둔하고 있는 것을 알았으니, 감히 추격하지 못할 것이다." 왕평, 장익, 오반, 오의에게 각각 두 갈래로 나누어 서천으로 천천히 후퇴하게 했다. 장합은 촉군이 후퇴하는 것을 보고 계책이 있을까 두려워 추격하지 않고, 사병을 이끌고 사마의에게 가서 말했다. "지금 촉군이 후퇴하는데, 그 뜻을 알 수 없습니다." 사마의가 말했다. "공명의 계책이 많으니 경솔히 움직이지 마라. 단단히 지키고 있으면 그들의 양식이 다 떨어지면 자연히 물러갈 것이다." 대장 위평이 나서며 말했다. "촉군이 기산의 진을 버리고 후퇴하니, 지금이야말로 승세를 타고 추격할 때입니다. 도독께서 병력을 움직이지 않고, 촉군을 두려워하시니 어찌 천하의 웃음거리가 되지 않겠습니까?" 사마의는 끝까지 따르지 않았다. 공명은 기산의 병력이 돌아온 것을 알고 마충과 양의를 불러 비밀스런 계책을 일러주며, 먼저 만 명의 궁노수를 이끌고 검각의 목문도에 매복시켜 위군이 추격해 오면 포성이 울리면 급히 나무와 돌을 굴려 그들의 퇴로를 차단하고 양쪽에서 일제히 화살을 쏘게 했다. 두 사람은 병력을 이끌고 떠났다. 또 위연과 관흥을 불러 병력을 이끌고 후미를 지키게 하고, 성벽 사방에 깃발을 꽂고 성 안에는 나무와 풀을 쌓아 놓고 헛되이 연기를 피우게 했다. 대군은 모두 검각 목문도로 향했다. 위군의 순찰병이 사마의에게 보고했다. "촉군 대부대는 이미 퇴각했으나, 성 안에 얼마나 많은 병력이 남아 있는지는 알 수 없습니다." 사마의는 직접 보러 갔다.성 위에 깃발이 꽂혀 있고 성 안에 연기가 피어오르는 것을 보고 사마의가 웃으며 말했다. "이는 빈 성이다." 사람을 보내 확인하니 과연 빈 성이었다. 사마의는 크게 기뻐하며 말했다. "공명이 이미 퇴각했으니 누가 감히 추격하겠는가?" 선봉장 장합이 말했다. "제가 가겠습니다." 사마의가 말렸다. "공의 성격이 급하니 가면 안 된다." 장합이 말했다. "도독께서 출정할 때 저를 선봉으로 임명하셨습니다. 오늘이야말로 공을 세울 기회인데 사용하지 않으시니 왜 그렇습니까?" 사마의가 말했다. "촉병이 퇴각했으나 험준한 곳에는 반드시 매복이 있을 것이니 매우 신중해야 한다." 장합이 말했다. "이미 알고 있으니 염려하지 마십시오." 사마의가 말했다. "공이 가고자 한다면 후회하지 마시오." 장합이 말했다. "대장부가 몸을 버려 나라에 보답하는데 만 번 죽어도 후회가 없습니다." 사마의가 말했다. "공이 그렇게 고집한다면 5천 병사를 앞세우고 가시오. 위평이 2만 병사를 이끌고 후속하며 매복을 대비할 것이오. 나는 3천 병사를 이끌고 뒤따르겠소." 장합이 명을 받고 병사를 이끌고 급히 추격했다. 30여 리를 가다가 갑자기 뒤에서 큰 함성이 들려오고 숲 속에서 한 무리의 군사가 나타나 선봉장으로 나선 장수가 칼을 휘두르며 외쳤다. "적장, 어디로 가는가!" 장합이 돌아보니 바로 위연이었다. 장합이 크게 분노하며 말을 돌려 교전했다. 십여 합을 겨루지 않아 위연이 거짓으로 패하여 달아났다. 장합이 다시 30여 리를 추격하다가 돌아보니 매복이 전혀 없었다. 다시 말을 달려 추격했다. 산비탈을 돌아서자 다시 큰 함성이 들려오고 한 무리의 군사가 나타났는데, 선봉장은 바로 관흥이었다. 관흥이 칼을 휘두르며 외쳤다. "장합, 도망가지 마라! 내가 여기에 있다!" 장합이 말을 몰아 교전했다. 십여 합을 겨루지 않아 관흥이 말을 돌려 달아났다. 장합이 다시 추격하여 밀림 속에 이르자 의심스러워 사람을 보내 사방을 수색하게 했으나 매복이 없었다. 안심하고 다시 추격했다. 예상치 못하게 위연이 앞에 나타나 장합과 십여 합을 겨루었다. 위연이 다시 패하여 달아났다. 장합이 분노하며 추격하니 이번에는 관흥이 앞에서 길을 막았다. 장합이 크게 분노하여 교전했다. 십여 합을 겨루지 않아 촉병이 갑옷과 물건을 버리고 길을 가득 메웠다. 위병은 모두 말에서 내려 이를 쟁탈했다. 위연과 관흥이 번갈아 교전했다. 장합이 용맹하게 추격했다. 날이 어두워질 때쯤 목문도 입구에 이르렀다. 위연이 말을 돌려 크게 외쳤다. "장합 역적! 내가 너와 결판을 내겠다!" 장합이 크게 분노하여 창을 휘두르며 말을 몰아 위연을 공격했다. 위연이 칼을 휘두르며 맞서 싸웠다. 십여 합을 겨루지 않아 위연이 크게 패하여 갑옷과 투구를 버리고 패잔병을 이끌고 목문도로 달아났다. 장합이 전투의 열기에 휩싸여 위연이 패하여 달아나는 것을 보고 말을 몰아 추격했다. 이때 어둠이 깔리고 한 발의 대포 소리와 함께 산 위에서 불빛이 하늘을 치솟고 큰 돌과 나뭇가지가 굴러 내려와 길을 막았다. 장합이 크게 놀라 말했다. "내가 계략에 빠졌구나!" 급히 말을 돌리려 했으나 이미 나무와 돌이 길을 막았고 중간에는 좁은 통로만 남았으며 양쪽은 절벽이었다. 장합은 진퇴양난에 빠졌다. 갑자기 큰 북소리가 나고 양쪽에서 만 개의 화살이 일제히 발사되어 장합과 수백 명의 부하 장수들이 목문도에서 모두 전사했다. 후인이 시를 남겼다. "매복한 화살이 별처럼 날아 목문도에서 용병을 쏘았네. 지금도 검각을 지나는 사람이 옛 군사의 이름을 말하네." 장합이 죽은 후 위병이 도착하여 길이 막힌 것을 보고 장합이 계략에 빠진 것을 알았다. 군사들이 급히 말을 돌려 퇴각했다. 갑자기 산 위에서 큰 목소리가 들렸다. "제갈 승상이 여기 있다!" 군사들이 올려다보니 공명이 불빛 속에 서서 군사들을 가리키며 말했다. "오늘 사냥을 하여 말을 쏘려 했으나 잘못하여 노루를 쏘았다. 너희는 안심하고 돌아가서 중달에게 전하라. 조만간 반드시 나에게 잡힐 것이다." 위병이 돌아가 사마의에게 보고했다. 사마의는 크게 슬퍼하며 하늘을 우러러 탄식했다. "장합이 의롭게 죽었으니 이는 나의 잘못이다!" 군사를 거두어 낙양으로 돌아갔다. 위주가 장합의 죽음을 듣고 눈물을 흘리며 탄식하며 그의 시체를 거두어 후장했다. 한편 공명은 한중으로 들어가 성도로 돌아가 후주를 만나려 했다. 도호 이엄이 후주에게 거짓으로 상주했다. "신은 이미 군량을 준비하여 곧 승상에게 보낼 예정인데, 승상이 어찌하여 갑자기 군을 철수하는지 알 수 없습니다." 후주가 이를 듣고 즉시 상서 비의를 한중으로 보내 공명에게 철수 이유를 물으라 명했다. 비의가 한중에 이르러 후주의 뜻을 전했다. 공명이 크게 놀라며 말했다. "이엄이 급한 서신을 보내 동오가 병력을 일으켜 촉을 침범하려 한다고 하여 군을 철수한 것이다." 비의가 말했다. "이엄의 상주에는 군량이 이미 준비되었고 승상이 이유 없이 철수하였다고 하여 천자가 저를 보내 물어오라 하셨습니다." 공명이 크게 노하여 사람을 시켜 조사하게 하니 이엄이 군량 준비가 미흡하여 승상의 죄를 두려워해 거짓 서신을 보냈음을 알게 되었다. 공명이 크게 노하여 말했다. "이 사내가 개인의 이익을 위해 국가의 대사를 망쳤구나!" 이엄을 불러 죽이려 했다. 비의가 말했다. "승상께서는 선제께서 고아를 부탁한 뜻을 생각하셔서 잠시 용서하시길 바랍니다." 공명이 그 말을 따랐다. 비의가 즉시 상주를 올려 천자에게 보고했다. 후주가 상주를 보고 크게 노하여 무사에게 명하여 이엄을 끌어내어 죽이려 했다. 참군 장완이 나와 말했다. "이엄은 선제께서 고아를 부탁한 신하이니 은혜를 베풀어 용서해주시길 바랍니다." 후주가 그 말을 따랐다. 이엄을 서인으로 강등하여 자통군으로 유배 보냈다. 공명이 성도로 돌아와 이엄의 아들 이풍을 장사로 임명했다. 초목을 쌓아 군량을 비축하고 진법을 논하고 무기를 정비하며 장수를 보살폈다. 3년 후 다시 출정했다. 두천의 백성과 군사들이 모두 그의 은덕을 우러렀다. 세월은 흘러 3년이 지나 건흥 12년 봄 2월이 되었다. 공명이 입조하여 말했다. "신이 지금 장수를 보살핀 지 3년이 지났습니다. 양식은 풍부하고 무기는 완비되었으며 병사와 말은 강성합니다. 이제 위를 정벌할 수 있습니다. 이번에 간신들을 모두 쓸어버리고 중원을 회복하지 않으면 폐하를 뵙지 않겠습니다!" 후주가 말했다. "지금 이미 삼국이 정립되어 있으니 오와 위가 침략하지 않았습니다. 승상께서 어찌하여 태평을 즐기지 않으십니까?" 공명이 말했다. "신은 천제의 은혜를 받아 꿈속에서도 항상 위를 정벌할 계책을 세우고 있습니다. 힘을 다해 중원을 회복하고 한실을 부흥시키는 것이 신의 소원입니다." 말을 마치기도 전에 반열에서 한 사람이 나와 말했다. "승상께서는 출병하면 안 됩니다." 모두가 보니 그 사람은 바로 교주였다.